{"ast":null,"code":"var _jsxFileName = \"/Users/konvict/Downloads/integrations_technical_assessment/frontend/src/integrations/hubspot.js\",\n  _s = $RefreshSig$();\nimport { useState, useEffect } from \"react\";\nimport { Box, Button, TextField } from \"@mui/material\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const HubspotIntegration = ({\n  user,\n  org,\n  integrationParams,\n  setIntegrationParams\n}) => {\n  _s();\n  const [loading, setLoading] = useState(false);\n  useEffect(() => {\n    // Cleanup if component unmounts\n    return () => {\n      setLoading(false);\n    };\n  }, []);\n  const handleAuthorize = async () => {\n    setLoading(true);\n    try {\n      // Step 1: ask backend for HubSpot OAuth URL\n      const resp = await axios.post(\"http://localhost:8000/integrations/hubspot/authorize\", new URLSearchParams({\n        user_id: user,\n        org_id: org\n      }));\n      const url = resp.data;\n\n      // Step 2: open OAuth popup\n      const popup = window.open(url, \"hubspot-oauth\", \"width=800,height=600\");\n\n      // Step 3: poll backend for credentials\n      const interval = setInterval(async () => {\n        try {\n          const credsResp = await axios.post(\"http://localhost:8000/integrations/hubspot/credentials\", new URLSearchParams({\n            user_id: user,\n            org_id: org\n          }));\n\n          // Success: credentials available\n          setIntegrationParams({\n            type: \"HubSpot\",\n            credentials: credsResp.data\n          });\n          clearInterval(interval);\n          if (popup) popup.close();\n          setLoading(false);\n        } catch (err) {\n          // ignore 400 until credentials are ready\n        }\n      }, 1500);\n\n      // Step 4: stop polling after 2 minutes max\n      setTimeout(() => {\n        clearInterval(interval);\n        setLoading(false);\n      }, 120000);\n    } catch (e) {\n      var _e$response, _e$response$data;\n      console.error(\"HubSpot auth error:\", e);\n      setLoading(false);\n      alert((e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : (_e$response$data = _e$response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.detail) || e.message);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(Box, {\n    display: \"flex\",\n    flexDirection: \"column\",\n    sx: {\n      width: 400\n    },\n    children: [/*#__PURE__*/_jsxDEV(TextField, {\n      label: \"Integration\",\n      value: \"HubSpot\",\n      sx: {\n        mt: 2\n      },\n      InputLabelProps: {\n        shrink: true\n      },\n      disabled: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      onClick: handleAuthorize,\n      sx: {\n        mt: 2\n      },\n      variant: \"contained\",\n      disabled: loading,\n      children: loading ? \"Authorizing HubSpot...\" : \"Connect HubSpot\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 5\n  }, this);\n};\n_s(HubspotIntegration, \"bp7W7BLZaxNmS0ceaCBH82+KoGQ=\");\n_c = HubspotIntegration;\nvar _c;\n$RefreshReg$(_c, \"HubspotIntegration\");","map":{"version":3,"names":["useState","useEffect","Box","Button","TextField","axios","jsxDEV","_jsxDEV","HubspotIntegration","user","org","integrationParams","setIntegrationParams","_s","loading","setLoading","handleAuthorize","resp","post","URLSearchParams","user_id","org_id","url","data","popup","window","open","interval","setInterval","credsResp","type","credentials","clearInterval","close","err","setTimeout","e","_e$response","_e$response$data","console","error","alert","response","detail","message","display","flexDirection","sx","width","children","label","value","mt","InputLabelProps","shrink","disabled","fileName","_jsxFileName","lineNumber","columnNumber","onClick","variant","_c","$RefreshReg$"],"sources":["/Users/konvict/Downloads/integrations_technical_assessment/frontend/src/integrations/hubspot.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { Box, Button, TextField } from \"@mui/material\";\nimport axios from \"axios\";\n\nexport const HubspotIntegration = ({\n  user,\n  org,\n  integrationParams,\n  setIntegrationParams,\n}) => {\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    // Cleanup if component unmounts\n    return () => {\n      setLoading(false);\n    };\n  }, []);\n\n  const handleAuthorize = async () => {\n    setLoading(true);\n    try {\n      // Step 1: ask backend for HubSpot OAuth URL\n      const resp = await axios.post(\n        \"http://localhost:8000/integrations/hubspot/authorize\",\n        new URLSearchParams({ user_id: user, org_id: org })\n      );\n      const url = resp.data;\n\n      // Step 2: open OAuth popup\n      const popup = window.open(url, \"hubspot-oauth\", \"width=800,height=600\");\n\n      // Step 3: poll backend for credentials\n      const interval = setInterval(async () => {\n        try {\n          const credsResp = await axios.post(\n            \"http://localhost:8000/integrations/hubspot/credentials\",\n            new URLSearchParams({ user_id: user, org_id: org })\n          );\n\n          // Success: credentials available\n          setIntegrationParams({\n            type: \"HubSpot\",\n            credentials: credsResp.data,\n          });\n          clearInterval(interval);\n          if (popup) popup.close();\n          setLoading(false);\n        } catch (err) {\n          // ignore 400 until credentials are ready\n        }\n      }, 1500);\n\n      // Step 4: stop polling after 2 minutes max\n      setTimeout(() => {\n        clearInterval(interval);\n        setLoading(false);\n      }, 120000);\n    } catch (e) {\n      console.error(\"HubSpot auth error:\", e);\n      setLoading(false);\n      alert(e?.response?.data?.detail || e.message);\n    }\n  };\n\n  return (\n    <Box display=\"flex\" flexDirection=\"column\" sx={{ width: 400 }}>\n      <TextField\n        label=\"Integration\"\n        value=\"HubSpot\"\n        sx={{ mt: 2 }}\n        InputLabelProps={{ shrink: true }}\n        disabled\n      />\n      <Button\n        onClick={handleAuthorize}\n        sx={{ mt: 2 }}\n        variant=\"contained\"\n        disabled={loading}\n      >\n        {loading ? \"Authorizing HubSpot...\" : \"Connect HubSpot\"}\n      </Button>\n    </Box>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}